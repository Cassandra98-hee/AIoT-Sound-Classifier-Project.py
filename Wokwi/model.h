// =====================================================
// Auto-generated model for ESP32
// Text Classification + Keyword Extraction
// =====================================================

#ifndef MODEL_H
#define MODEL_H

#include <string.h>
#include <ctype.h>
#include <math.h>

#define MAX_TEXT_LEN 512
#define MAX_KEYWORDS 5

const char* CATEGORIES[] = {"World", "Sports", "Business", "Sci-Tech"};
const int NUM_CLASSES = 4;

const int VOCAB_SIZE = 300;
const char* VOCAB[] = {
    "afghanistan",
    "afp",
    "airbus",
    "airline",
    "airport",
    "airway",
    "al",
    "amp",
    "ap",
    "apple",
    "arafat",
    "army",
    "astronaut",
    "astronomer",
    "athens",
    "athens greece",
    "athlete",
    "athletic",
    "attack",
    "auburn",
    "baghdad",
    "bank",
    "baseball",
    "basketball",
    "billion",
    "bird",
    "blog",
    "bn",
    "bomb",
    "bombing",
    "boston",
    "bowl",
    "boxing",
    "broadband",
    "browser",
    "bryant",
    "business",
    "cambodia",
    "canadian press",
    "captain",
    "casino",
    "ceo",
    "champion",
    "championship",
    "child",
    "chip",
    "cleveland",
    "clone",
    "club",
    "coach",
    "code",
    "college",
    "com",
    "company",
    "computer",
    "consumer",
    "copyright",
    "corp",
    "corporate",
    "corporation",
    "cricket",
    "cup",
    "currency",
    "customer",
    "cyber",
    "darfur",
    "data",
    "debt",
    "democracy",
    "democrat",
    "design",
    "detroit",
    "developer",
    "digital",
    "disney",
    "dollar",
    "dope",
    "dvd",
    "earnings",
    "earth",
    "earthquake",
    "economic",
    "economy",
    "election",
    "electronic",
    "enron",
    "environmental",
    "espn",
    "evolution",
    "executive",
    "federal",
    "finance",
    "firm",
    "fla",
    "food",
    "football",
    "forbes",
    "forbes com",
    "formula",
    "formula one",
    "friday",
    "fund",
    "game",
    "golf",
    "google",
    "government",
    "group",
    "growth",
    "hacker",
    "halliburton",
    "he",
    "hellip",
    "his",
    "hostage",
    "house",
    "hp",
    "human",
    "ibm",
    "inc",
    "indonesia",
    "industry",
    "insurance",
    "insurer",
    "intel",
    "intelligence",
    "internet",
    "investment",
    "investor",
    "iran",
    "iraq",
    "iraqi",
    "israel",
    "israeli",
    "japan",
    "kashmir",
    "kill",
    "kobe",
    "kobe bryant",
    "last night",
    "launch",
    "leader",
    "league",
    "linux",
    "london reuters",
    "madrid",
    "maker",
    "management",
    "manager",
    "manchester",
    "manchester united",
    "mar",
    "market",
    "martha",
    "martha stewart",
    "massachusetts",
    "match",
    "merger",
    "miami",
    "microsoft",
    "mike",
    "militant",
    "military",
    "minister",
    "mobile",
    "moon",
    "mortgage",
    "mp",
    "murder",
    "music",
    "muslim",
    "nasa",
    "nascar",
    "nba",
    "newsfactor",
    "nfl",
    "nhl",
    "night",
    "nintendo",
    "nuclear",
    "nyse",
    "offense",
    "oil",
    "oil price",
    "olympic",
    "olympics",
    "online",
    "opec",
    "oracle",
    "pakistan",
    "palestinian",
    "parliament",
    "party",
    "pc",
    "pc world",
    "peace",
    "peoplesoft",
    "phone",
    "pitcher",
    "plant",
    "play",
    "player",
    "point",
    "police",
    "political",
    "president",
    "presidential",
    "price",
    "prince",
    "prize",
    "processor",
    "profit",
    "quarterback",
    "race",
    "rebel",
    "regulator",
    "republican",
    "research",
    "researcher",
    "retailer",
    "reuters",
    "robot",
    "round",
    "sale",
    "saturday",
    "say",
    "science",
    "scientist",
    "season",
    "security",
    "server",
    "service",
    "shareholder",
    "ship",
    "soccer",
    "software",
    "soldier",
    "sox",
    "space",
    "spacecraft",
    "spaceshipone",
    "spam",
    "specie",
    "sport",
    "sport network",
    "stadium",
    "steroid",
    "stock",
    "store",
    "striker",
    "study",
    "sudan",
    "sun",
    "sunday",
    "system",
    "taiwan",
    "tax",
    "team",
    "technology",
    "tennis",
    "terrorism",
    "the company",
    "the dollar",
    "the you",
    "theory",
    "ticker",
    "title",
    "toronto",
    "tournament",
    "toy",
    "treasury",
    "troop",
    "un",
    "union",
    "united nation",
    "user",
    "victory",
    "video",
    "video game",
    "vioxx",
    "virus",
    "voip",
    "voter",
    "war",
    "washington reuters",
    "washingtonpost",
    "washingtonpost com",
    "web",
    "website",
    "williams",
    "win",
    "wireless",
    "worker",
    "worm",
    "yahoo",
    "yankee",
    "yesterday",
    "york reuters",
    "york stock",
    "your",
    "yukos"
};

const float IDF[] = {
    6.1456f, 4.8553f, 7.2314f, 5.5399f, 6.5447f, 6.4727f, 5.3668f, 5.5406f,
    3.6486f, 5.6904f, 6.0619f, 5.8377f, 7.1384f, 7.5833f, 5.5114f, 7.1462f,
    7.5595f, 7.7536f, 4.8542f, 7.4535f, 5.3616f, 5.0197f, 5.9762f, 6.3340f,
    4.7132f, 6.9749f, 7.8201f, 7.0821f, 5.6085f, 6.5152f, 5.4698f, 6.3134f,
    7.7116f, 6.8634f, 6.6222f, 7.2971f, 4.5708f, 8.4468f, 6.5750f, 6.3908f,
    7.6077f, 6.3496f, 5.0829f, 5.3383f, 6.0398f, 5.5911f, 6.8036f, 8.1414f,
    5.8097f, 5.0653f, 6.6889f, 6.3000f, 5.0939f, 3.5856f, 4.6747f, 5.2825f,
    7.0712f, 4.2114f, 6.1008f, 6.6718f, 6.6199f, 5.0532f, 6.8459f, 5.5023f,
    8.0509f, 6.0554f, 5.3596f, 6.4826f, 7.1384f, 6.9395f, 5.8046f, 6.3945f,
    6.5728f, 5.7589f, 6.9269f, 5.1347f, 7.2971f, 6.7113f, 5.3941f, 6.4491f,
    6.9332f, 5.5091f, 5.5061f, 4.7913f, 6.6361f, 7.2572f, 7.4020f, 7.7116f,
    8.0318f, 4.9833f, 4.9091f, 6.3151f, 5.2365f, 6.9459f, 5.9018f, 5.5046f,
    7.8432f, 8.2066f, 6.6988f, 6.9022f, 3.8774f, 5.7785f, 4.0194f, 6.7164f,
    5.5854f, 4.2539f, 4.3043f, 5.3874f, 7.3062f, 7.9078f, 3.8115f, 8.9111f,
    3.3041f, 5.8067f, 5.6786f, 7.3820f, 6.0007f, 5.6322f, 3.9568f, 6.9301f,
    5.0427f, 6.3254f, 7.2528f, 5.8984f, 6.8722f, 4.6209f, 5.9982f, 5.2952f,
    5.9666f, 4.4689f, 5.1648f, 5.8984f, 5.5290f, 5.3512f, 6.9587f, 4.4562f,
    7.4803f, 7.5248f, 5.6751f, 4.9886f, 4.6959f, 4.8764f, 6.0296f, 6.2322f,
    6.3835f, 4.8133f, 5.8294f, 5.5274f, 6.2385f, 6.4434f, 6.9053f, 4.4887f,
    7.4641f, 7.5135f, 7.3481f, 5.5620f, 6.6315f, 6.2785f, 4.6027f, 6.4319f,
    5.4896f, 5.2452f, 4.5265f, 5.3332f, 6.6694f, 6.7981f, 7.2528f, 6.8203f,
    5.3505f, 6.1442f, 5.8829f, 7.2063f, 6.6694f, 7.1540f, 6.3236f, 7.1193f,
    4.4340f, 7.3674f, 5.5152f, 6.7240f, 7.0185f, 4.3663f, 5.0206f, 5.4097f,
    6.2245f, 5.0314f, 7.1307f, 5.8569f, 5.8601f, 5.2528f, 6.6791f, 5.5862f,
    5.6609f, 7.3920f, 5.8046f, 5.9678f, 5.1004f, 6.7683f, 6.4186f, 5.0859f,
    4.8156f, 4.9735f, 5.1515f, 5.7905f, 4.1264f, 5.4771f, 4.2506f, 7.1818f,
    6.5640f, 6.4262f, 4.8976f, 6.0398f, 5.4397f, 5.6194f, 6.1091f, 6.4167f,
    5.0018f, 6.1328f, 5.8159f, 3.2268f, 7.7900f, 5.2687f, 4.7183f, 4.4005f,
    2.5676f, 6.6963f, 5.5764f, 4.4415f, 4.4148f, 5.8644f, 4.3675f, 6.4376f,
    6.8431f, 6.5489f, 4.5448f, 5.8190f, 5.6194f, 5.2735f, 6.7818f, 7.8125f,
    6.6574f, 7.0498f, 4.9472f, 5.5620f, 5.9291f, 7.5654f, 4.3382f, 5.4152f,
    6.6479f, 5.9314f, 6.1865f, 5.9465f, 4.2149f, 4.7067f, 6.9982f, 5.9714f,
    4.3812f, 4.6753f, 6.7954f, 6.4149f, 4.5433f, 5.9642f, 5.2533f, 8.0131f,
    7.0358f, 5.5772f, 6.0752f, 6.3134f, 7.6980f, 6.8811f, 5.5414f, 5.7618f,
    5.1420f, 5.9325f, 5.3447f, 4.7388f, 5.6504f, 6.5532f, 7.1501f, 6.4648f,
    7.9246f, 6.5860f, 5.2250f, 6.2967f, 6.9022f, 6.9022f, 5.2103f, 7.0498f,
    6.1542f, 4.4032f, 5.5159f, 5.5430f, 7.1080f, 6.5340f, 5.8536f, 3.9804f,
    5.0036f, 7.7753f, 5.8420f, 6.7577f
};

const float INTERCEPT[] = {0.027722f, -0.254128f, 0.130872f, 0.095534f};

const float COEF[4][VOCAB_SIZE] = {
    {3.579556f, 9.940647f, -1.353868f, -0.462479f, 1.288482f, -0.198548f, 3.263950f, -2.501910f,
     4.810625f, -1.722751f, 3.473687f, 3.182662f, -0.988699f, -0.985250f, 0.562324f, 3.990554f,
     -1.190571f, -0.851170f, 2.399186f, -0.939825f, 3.558858f, -0.712536f, -1.344057f, -1.300921f,
     -0.505825f, -0.375611f, -1.121973f, 0.235858f, 2.856814f, 2.829883f, 0.170670f, -1.065660f,
     -0.670881f, -0.894285f, -0.512853f, -0.945970f, -1.602100f, 2.612656f, 5.726049f, -0.381212f,
     -0.681889f, -2.350584f, -0.517011f, -0.416166f, 2.612968f, -0.757705f, -1.199680f, -1.314845f,
     -1.168513f, -1.632938f, -0.519640f, -1.409287f, -1.690696f, -2.327445f, -2.556813f, -1.037757f,
     -1.107513f, -1.323601f, -1.036306f, -1.643068f, -1.664372f, -1.421855f, -0.700787f, -1.107255f,
     -1.229269f, 3.503358f, -1.589871f, 0.110826f, 2.762206f, 2.960074f, -1.102537f, -1.144386f,
     -1.428744f, -1.330411f, -1.404741f, -0.379234f, -1.234564f, -1.086553f, 0.473043f, -0.068104f,
     1.361048f, 0.634846f, 0.266881f, 4.237527f, -0.893034f, -1.164259f, -0.906525f, -0.773823f,
     -1.119732f, -1.715785f, -1.035182f, -1.303643f, -1.573233f, 2.529584f, 1.054401f, -2.224702f,
     -0.989813f, -0.863097f, -0.311430f, -0.261472f, 1.156061f, -0.236195f, -2.693493f, -0.862260f,
     -1.277115f, 2.738273f, 0.251355f, -1.245604f, -1.152855f, -1.454899f, -0.312634f, -0.286602f,
     1.142755f, 4.088664f, 1.448564f, -0.512678f, 0.329663f, -1.884027f, -2.432029f, 2.533025f,
     -1.894049f, -0.747088f, -0.634991f, -1.314129f, 2.677583f, -3.520234f, -2.130123f, 1.664270f,
     4.195557f, 6.212572f, 5.183730f, 3.611095f, 3.284274f, 2.755528f, 3.122649f, 3.883749f,
     -0.974990f, -0.880132f, -1.246232f, -0.930614f, 4.409563f, -0.720467f, -1.321481f, -1.281852f,
     -0.083733f, -1.077712f, -1.769547f, -2.452322f, -0.380593f, -0.568424f, -0.448638f, -1.816250f,
     -0.990216f, -0.770217f, -1.232186f, -0.790948f, -1.794116f, 0.757578f, -3.209658f, -1.440689f,
     3.361804f, 4.722626f, 3.033473f, -1.562040f, -0.500348f, -0.742793f, 1.195665f, 3.180735f,
     0.455486f, 3.741513f, -1.744478f, -2.005182f, -1.114146f, -0.346241f, -1.090213f, -0.812374f,
     0.764974f, -1.020670f, 5.074165f, -1.413196f, -0.697609f, 0.741522f, 0.854942f, -0.406719f,
     -0.961901f, -3.033875f, -1.693059f, -1.860514f, 3.303097f, 4.708143f, 2.826669f, 3.335532f,
     -1.451477f, -0.561472f, 3.857981f, -1.813776f, -1.816593f, -1.396220f, -1.050682f, -0.274669f,
     -2.686984f, -0.766568f, 2.585877f, 3.142949f, 4.921110f, 2.132222f, -0.806346f, 3.450759f,
     0.544658f, -1.016696f, -0.246380f, -1.036590f, -0.238652f, 3.603672f, -1.192876f, 2.798319f,
     -0.301201f, 0.639739f, -1.666047f, 0.414408f, -1.268434f, -1.095695f, -1.385976f, 0.755479f,
     1.901413f, -1.683003f, -0.025912f, -1.984721f, 2.097245f, -0.871612f, -0.475801f, -1.457115f,
     -0.571173f, -1.239344f, -3.001737f, 2.821057f, -0.307377f, -1.703552f, -0.678777f, -0.606666f,
     -0.957540f, -0.059109f, -2.423253f, -0.989136f, -0.944438f, -1.101777f, 0.530031f, -1.538877f,
     -1.247737f, -1.226110f, 2.955676f, -1.142229f, 1.449285f, -1.096294f, 2.625544f, -0.667476f,
     -1.528314f, -1.961692f, -0.620030f, 3.604471f, -1.225736f, -0.436952f, 1.627039f, -0.964202f,
     -1.135241f, -1.176597f, -1.078118f, -0.646737f, -0.417127f, -0.970663f, 4.104531f, 3.548821f,
     0.637598f, 2.914239f, -0.851730f, 0.433401f, -0.295430f, -1.278426f, -0.319352f, 0.630818f,
     -0.525606f, 2.532401f, 2.802608f, -1.453180f, 0.088492f, 0.090509f, -1.906980f, -1.748196f,
     -0.445588f, 0.451803f, -2.395873f, 0.874489f, -1.695912f, -1.064781f, -0.186342f, -0.487028f,
     -4.408992f, 3.231197f, -1.647472f, -0.834594f},
    {-0.758007f, -5.818893f, -0.511402f, -2.159794f, -1.537531f, -1.207626f, -0.482740f, -1.111139f,
     4.380148f, -1.609973f, -1.383063f, -1.821717f, -1.573281f, -1.197107f, 3.777462f, -3.231218f,
     2.557500f, 2.595511f, -1.382180f, 2.723298f, -1.032252f, -1.785625f, 5.668177f, 3.734848f,
     -2.379086f, -1.232828f, -0.635049f, -0.954741f, -1.289135f, -1.035675f, 0.073340f, 3.700096f,
     2.868299f, -0.628854f, -0.904169f, 2.926785f, -2.902377f, -0.901788f, -1.397676f, 2.617751f,
     -0.905408f, -1.941623f, 4.628288f, 4.052693f, -2.124179f, -1.649640f, 2.663363f, -0.543875f,
     4.040369f, 7.073074f, -1.035891f, 2.879397f, -0.966430f, -4.779486f, -3.138777f, -2.305641f,
     -0.793769f, -2.567142f, -1.609883f, -1.084936f, 5.529971f, 6.308398f, -0.893944f, -1.867254f,
     -0.834700f, -0.916439f, -1.635170f, -0.751082f, -0.753130f, -1.347441f, -1.259142f, 1.003270f,
     -1.426243f, -1.623157f, -1.119574f, -1.765550f, 3.537948f, -1.180714f, -1.377756f, -1.914892f,
     -1.256010f, -2.218830f, -1.778009f, -3.092755f, -1.431599f, -1.110820f, -0.769952f, 2.653719f,
     -0.875892f, -2.047117f, -2.085837f, -0.229824f, -1.448669f, -0.220163f, -2.048588f, 5.480122f,
     -0.643194f, -0.581007f, 2.929022f, 2.658896f, 1.497154f, -1.527597f, 3.330019f, 2.665540f,
     -1.910449f, -3.467230f, -2.577534f, -1.530354f, -0.514093f, -0.209026f, 2.882267f, -0.184979f,
     2.561291f, -1.478042f, -2.271481f, -0.517876f, -1.528799f, -1.796334f, -2.811522f, -0.852850f,
     -3.196729f, -1.361408f, -0.714180f, -1.586262f, -0.774831f, -2.701990f, -0.902309f, -2.421744f,
     -1.024155f, -2.447356f, -2.039703f, -0.899971f, -0.845437f, -1.109966f, -1.086283f, -0.365103f,
     2.810152f, 2.566636f, 2.574249f, -2.028513f, -1.112179f, 5.048382f, -1.069673f, 1.026529f,
     2.589793f, -2.009042f, -0.953921f, 3.445250f, 3.120739f, 2.925235f, -1.078984f, -3.357383f,
     -1.038284f, -1.005511f, -0.571123f, 3.026338f, -1.078692f, 2.496336f, -3.059551f, 2.553064f,
     -0.874508f, -1.618666f, -2.658693f, -1.376018f, -1.281393f, -0.631249f, -1.247281f, -1.569441f,
     -2.948944f, -1.093184f, -1.855675f, 4.581822f, 3.557535f, -0.233152f, 3.118883f, 3.343134f,
     2.518370f, -1.357977f, -1.979532f, -1.110228f, 2.596946f, -2.487699f, -1.011104f, 5.164306f,
     3.935559f, -2.204665f, -0.329808f, -1.556858f, 0.044831f, -1.421864f, -1.195514f, -1.239351f,
     -1.701453f, -0.489241f, -0.903081f, -1.813552f, -1.639059f, 3.472759f, -1.851689f, 3.028586f,
     5.354370f, 2.733223f, -0.372457f, -2.411150f, -3.228504f, -2.875559f, -2.429671f, -1.517146f,
     -1.523976f, -0.858984f, -2.025294f, 4.361261f, 3.199225f, -1.015815f, -1.214554f, -2.032442f,
     -2.590814f, -2.336194f, -1.757855f, -2.441288f, -0.564421f, 2.566930f, -1.829996f, 3.341989f,
     -3.253819f, -1.684498f, -3.113149f, 4.533941f, -2.410519f, -0.973505f, -3.014764f, -1.080232f,
     -1.033166f, 3.482685f, -2.827340f, -0.865793f, 3.066290f, -3.441138f, -1.080642f, -1.150141f,
     -0.947932f, -1.222594f, 6.197658f, 2.614807f, 4.804172f, 2.672878f, -2.269225f, -2.386312f,
     3.216631f, -1.888432f, -0.673842f, 0.149854f, 3.248947f, -2.953858f, -0.964310f, -1.459177f,
     6.540268f, -3.594983f, 3.162878f, -1.258081f, -2.069572f, -0.885884f, -2.305171f, -0.656828f,
     2.677253f, 2.368216f, 1.716684f, 2.803593f, -1.052710f, -0.627584f, -1.180487f, -1.600588f,
     -1.058652f, -1.203384f, -1.608243f, 2.989718f, -2.435024f, -1.769775f, -0.738694f, -1.247718f,
     -0.336721f, -1.419468f, -2.032314f, -0.459402f, -0.510598f, -0.508017f, -1.714535f, -0.006387f,
     3.084214f, 2.548660f, -1.962493f, -2.770692f, -0.578624f, -0.857293f, 3.528558f, 2.663601f,
     1.261507f, -0.411197f, -1.228983f, -0.647233f},
    {-1.625105f, -3.921992f, 2.548818f, 4.646286f, 1.432432f, 3.449282f, -1.299479f, 3.930963f,
     -14.114070f, -1.428959f, -1.057114f, 0.252628f, -1.117579f, -0.863327f, -2.192980f, -0.586669f,
     -0.744788f, -0.605613f, -1.210221f, -0.708425f, -0.898065f, 4.492411f, -2.327869f, -0.885288f,
     2.928815f, -1.327236f, -1.202700f, 2.563135f, -1.378124f, -0.999462f, 2.340448f, -1.062578f,
     -1.056010f, -1.008051f, -1.342509f, -1.005999f, 2.954440f, -0.918296f, -2.784388f, -1.456300f,
     2.698792f, 1.377343f, -1.858383f, -1.998016f, -0.274277f, -0.282839f, -0.486220f, -0.734220f,
     -0.665758f, -2.391550f, -1.015520f, -0.455249f, -1.148451f, 4.006954f, 1.033870f, 2.276378f,
     -0.730886f, 3.408004f, 2.728855f, 2.599446f, -2.286925f, -2.190409f, 2.556388f, 1.115767f,
     -0.664544f, -1.214895f, 1.000934f, 2.829286f, -1.012436f, -0.321168f, -0.165152f, 1.870068f,
     1.381003f, 0.567281f, 2.842923f, 2.946560f, -1.281672f, -0.908331f, 2.068979f, -0.761141f,
     -1.410307f, 4.152632f, 3.988481f, -0.127154f, -0.257399f, 3.755120f, -0.928701f, -0.822996f,
     -0.916413f, 2.235206f, 2.625528f, 3.187530f, 2.391510f, -1.874201f, 1.719738f, -1.445513f,
     3.296889f, 2.864198f, -1.335262f, -1.022924f, -0.485029f, 3.047251f, -2.994598f, -0.695367f,
     0.241865f, 0.624763f, 2.090759f, 2.391536f, -1.059381f, 2.755955f, -0.607212f, 4.478521f,
     -1.396339f, -1.477070f, 1.292215f, -1.921753f, -1.615021f, 0.672828f, 3.575849f, -0.983014f,
     2.870798f, 3.635796f, 2.844293f, 0.353240f, -1.692147f, 0.257954f, 3.477947f, 2.405301f,
     -1.209645f, -1.126035f, -1.249608f, -1.727930f, -1.516172f, -0.756579f, -1.353168f, -2.525934f,
     -0.857970f, -0.785123f, 0.089049f, 0.274736f, -1.389758f, -2.486437f, -2.115913f, 1.668674f,
     -1.065366f, 2.681605f, 1.002372f, 0.021227f, -1.291644f, -1.308525f, -1.268253f, 3.040408f,
     2.837631f, 2.826768f, 2.706393f, -0.848977f, 2.603642f, -1.456466f, 1.256515f, -1.255690f,
     -1.395490f, -2.203464f, 0.654537f, 0.082548f, -1.387343f, 2.821573f, -1.453604f, -1.077807f,
     -0.067381f, -1.206749f, -2.608327f, -1.234694f, -1.025760f, -2.500981f, -0.833489f, -1.310334f,
     -1.389108f, -0.413437f, -2.607198f, 2.909202f, -0.739975f, 4.820082f, 1.699613f, -2.570553f,
     -1.582155f, 0.302804f, 2.782285f, 0.535304f, -1.369513f, -1.842994f, -0.904757f, -1.324927f,
     0.392905f, -1.587705f, -1.308772f, 1.876985f, 0.581421f, -1.021863f, 2.060441f, -1.400038f,
     -2.213903f, -1.045493f, -1.556944f, -0.619743f, 0.338920f, 0.462740f, 2.838283f, -1.112674f,
     -1.188818f, -0.863416f, 3.284718f, -1.395554f, -1.757658f, -0.771395f, 2.781831f, 0.528968f,
     0.471396f, -1.372292f, 4.189486f, -1.761816f, -0.787192f, -0.987216f, 2.867782f, -1.277970f,
     0.372643f, 0.022129f, -2.303554f, -0.867773f, -1.585489f, -1.084082f, 0.927767f, 2.661647f,
     -1.427087f, -1.269461f, -0.024603f, -1.340284f, -1.065751f, -1.447439f, -0.973856f, -1.032002f,
     -1.754875f, -1.406731f, -1.821980f, -0.793358f, -1.548930f, -0.948618f, 3.556451f, 2.851325f,
     -0.869183f, -0.185970f, -1.049323f, -1.620296f, -1.317570f, 0.462423f, -1.679554f, 4.287908f,
     -3.288187f, 1.087296f, -1.208477f, -1.517526f, 1.537537f, 2.817596f, -0.491844f, -0.985906f,
     -0.750627f, -1.521388f, 1.133965f, -1.103290f, 2.911562f, 2.598231f, -1.548906f, -1.509830f,
     2.519511f, -1.699024f, -0.515497f, -1.094032f, -0.103394f, 0.083569f, 2.654039f, -1.560098f,
     -1.765284f, -0.965693f, -0.801555f, 3.089770f, -2.237561f, -2.356995f, -0.801042f, -0.794229f,
     -1.225842f, -1.195633f, 0.882895f, 2.440686f, -0.861210f, -1.228038f, -1.972072f, 1.843019f,
     4.793564f, -2.716511f, 1.887698f, 2.939486f},
    {-1.196444f, -0.199762f, -0.683548f, -2.024013f, -1.183383f, -2.043108f, -1.481731f, -0.317914f,
     4.923297f, 4.761684f, -1.033510f, -1.613574f, 3.679559f, 3.045684f, -2.146806f, -0.172666f,
     -0.622141f, -1.138728f, 0.193215f, -1.075048f, -1.628541f, -1.994250f, -1.996251f, -1.548638f,
     -0.043904f, 2.935675f, 2.959722f, -1.844253f, -0.189555f, -0.794747f, -2.584457f, -1.571858f,
     -1.141408f, 2.531190f, 2.759531f, -0.974816f, 1.550037f, -0.792573f, -1.543985f, -0.780239f,
     -1.111494f, 2.914865f, -2.252893f, -1.638511f, -0.214513f, 2.690184f, -0.977463f, 2.592939f,
     -2.206098f, -3.048585f, 2.571051f, -1.014861f, 3.805577f, 3.099977f, 4.661720f, 1.067020f,
     2.632167f, 0.482739f, -0.082666f, 0.128558f, -1.578673f, -2.696133f, -0.961658f, 1.858743f,
     2.728512f, -1.372024f, 2.224108f, -2.189029f, -0.996640f, -1.291465f, 2.526831f, -1.728953f,
     1.473984f, 2.386287f, -0.318608f, -0.801775f, -1.021713f, 3.175599f, -1.164266f, 2.744137f,
     1.305269f, -2.568648f, -2.477354f, -1.017619f, 2.582032f, -1.480041f, 2.605179f, -1.056900f,
     2.912036f, 1.527695f, 0.495490f, -1.654064f, 0.630393f, -0.435220f, -0.725551f, -1.809907f,
     -1.663883f, -1.420094f, -1.282330f, -1.374500f, -2.168186f, -1.283460f, 2.358072f, -1.107914f,
     2.945700f, 0.104194f, 0.235421f, 0.384422f, 2.726329f, -1.092030f, -1.962420f, -4.006939f,
     -2.307708f, -1.133552f, -0.469298f, 2.952307f, 2.814157f, 3.007533f, 1.667702f, -0.697161f,
     2.219981f, -1.527300f, -1.495122f, 2.547150f, -0.210605f, 5.964270f, -0.445514f, -1.647827f,
     -1.961756f, -2.639181f, -1.894419f, -0.983195f, -0.922665f, -0.888984f, -0.683198f, -0.992712f,
     -0.977192f, -0.901381f, -1.417067f, 2.684391f, -1.907627f, -1.841477f, 4.507068f, -1.413351f,
     -1.440695f, 0.405149f, 1.721096f, -1.014154f, -1.448502f, -1.048286f, 2.795875f, 2.133226f,
     -0.809131f, -1.051039f, -0.903084f, -1.386412f, 0.269165f, -1.797448f, 5.012694f, 0.143315f,
     -1.091807f, -0.900496f, -1.029317f, 2.855510f, 3.169084f, -1.447531f, 1.505220f, -0.533488f,
     2.560839f, -1.441579f, 6.208479f, -1.341947f, -1.417630f, 3.080375f, -1.195180f, -1.220426f,
     -1.894236f, 2.792084f, -0.487436f, -0.385778f, -1.159362f, -3.073906f, -1.543450f, -2.187034f,
     -1.391503f, 4.935736f, -0.759418f, 2.882068f, -1.978415f, -1.443285f, -0.726398f, -0.771254f,
     2.760025f, 2.638418f, -1.646128f, 1.750344f, 2.874230f, -1.054675f, 0.841930f, -1.353879f,
     -0.453483f, -0.921162f, -0.656477f, -0.112057f, -2.031526f, 0.280597f, 0.397734f, -0.820939f,
     2.168136f, 2.739096f, -1.013043f, -1.929117f, -1.202915f, -1.816462f, -0.374401f, -1.294844f,
     2.420618f, 3.068747f, -0.765584f, 3.788696f, 2.620047f, -0.484019f, 0.348190f, -2.819498f,
     0.979763f, 3.345372f, 5.442615f, -1.681447f, 1.898764f, 2.929199f, 2.562799f, -0.124299f,
     3.031427f, -0.973880f, 5.853680f, -0.614979f, -1.693162f, 6.592129f, 2.733274f, 2.788808f,
     3.660347f, 2.688434f, -1.952425f, -0.832313f, -2.310805f, -0.622483f, -1.817257f, 1.073864f,
     -1.099711f, 3.300511f, -1.232511f, 2.612672f, -3.380662f, 3.587729f, 0.018320f, -2.161255f,
     -1.723767f, 4.469380f, -1.334371f, -0.828865f, 1.757771f, -1.494760f, 1.169976f, 2.606936f,
     -0.791384f, 0.329769f, -1.772531f, -1.053566f, -1.441725f, -0.999985f, -1.375138f, -0.438402f,
     -2.098457f, -0.011831f, 2.975470f, -2.329087f, 2.833848f, 2.964632f, -1.595993f, 2.176999f,
     2.627612f, -0.147240f, 0.031261f, -1.177188f, 2.659666f, 2.774503f, 4.422557f, 2.548812f,
     -1.412784f, -1.804830f, 3.475471f, -0.544483f, 3.135746f, 3.150113f, -1.370144f, -4.019593f,
     -1.646079f, -0.103489f, 0.988756f, -1.457659f}
};

void preprocessText(char* text) {
    int j = 0;
    for (int i = 0; text[i]; i++) {
        char c = text[i];
        if (isalpha(c) || c == ' ') {
            text[j++] = tolower(c);
        } else {
            text[j++] = ' ';
        }
    }
    text[j] = '\0';
    j = 0;
    int lastSpace = 1;
    for (int i = 0; text[i]; i++) {
        if (text[i] == ' ') {
            if (!lastSpace) { text[j++] = ' '; lastSpace = 1; }
        } else {
            text[j++] = text[i]; lastSpace = 0;
        }
    }
    if (j > 0 && text[j-1] == ' ') j--;
    text[j] = '\0';
}

int findTerm(const char* text, const char* term) {
    int textLen = strlen(text);
    int termLen = strlen(term);
    for (int i = 0; i <= textLen - termLen; i++) {
        if (strncmp(text + i, term, termLen) == 0) {
            int startOk = (i == 0 || text[i - 1] == ' ');
            int endOk = (text[i + termLen] == '\0' || text[i + termLen] == ' ');
            if (startOk && endOk) return 1;
        }
    }
    return 0;
}

int predictCategory(const char* inputText) {
    char text[MAX_TEXT_LEN];
    strncpy(text, inputText, MAX_TEXT_LEN - 1);
    text[MAX_TEXT_LEN - 1] = '\0';
    preprocessText(text);
    
    float scores[NUM_CLASSES];
    for (int c = 0; c < NUM_CLASSES; c++) scores[c] = INTERCEPT[c];
    
    for (int i = 0; i < VOCAB_SIZE; i++) {
        if (findTerm(text, VOCAB[i])) {
            for (int c = 0; c < NUM_CLASSES; c++) scores[c] += COEF[c][i];
        }
    }
    
    int best = 0;
    for (int c = 1; c < NUM_CLASSES; c++) {
        if (scores[c] > scores[best]) best = c;
    }
    return best;
}

int extractKeywords(const char* inputText, const char* keywords[], int topN) {
    char text[MAX_TEXT_LEN];
    strncpy(text, inputText, MAX_TEXT_LEN - 1);
    text[MAX_TEXT_LEN - 1] = '\0';
    preprocessText(text);
    
    if (topN > MAX_KEYWORDS) topN = MAX_KEYWORDS;
    
    float scores[VOCAB_SIZE];
    for (int i = 0; i < VOCAB_SIZE; i++) {
        scores[i] = findTerm(text, VOCAB[i]) ? IDF[i] : 0;
    }
    
    int found = 0;
    for (int k = 0; k < topN; k++) {
        int best = -1;
        float bestScore = 0;
        for (int i = 0; i < VOCAB_SIZE; i++) {
            if (scores[i] > bestScore) { bestScore = scores[i]; best = i; }
        }
        if (best >= 0 && bestScore > 0) {
            keywords[found++] = VOCAB[best];
            scores[best] = 0;
        }
    }
    return found;
}

#endif
